# –ò–≥—Ä–∞–µ–º –≤ Mortal Kombat —Å TensorFlow.js: –ø–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö 

*–ü–µ—Ä–µ–≤–æ–¥ —Å—Ç–∞—Ç—å–∏ [Minko Gechev](https://blog.mgechev.com/): [Playing Mortal Kombat with TensorFlow.js. Transfer learning and data augmentation](https://blog.mgechev.com/2018/10/20/transfer-learning-tensorflow-js-data-augmentation-mobile-net/).*

***

–í–æ –≤—Ä–µ–º—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ [Guess.js](https://github.com/guess-js/guess) —è –Ω–∞—á–∞–ª –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ. –î–æ —ç—Ç–æ–≥–æ —è –±–æ–ª—å—à–µ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–ª—Å—è –Ω–∞ [—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö](https://ru.wikipedia.org/wiki/–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è_–Ω–µ–π—Ä–æ–Ω–Ω–∞—è_—Å–µ—Ç—å) (RNN), –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ [–¥–æ–ª–≥–æ–π –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –ø–∞–º—è—Ç–∏](https://ru.wikipedia.org/wiki/–î–æ–ª–≥–∞—è_–∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è_–ø–∞–º—è—Ç—å) LSTM, –∏–∑-–∑–∞ –∏—Ö [¬´–Ω–µ–æ–±—ä—è—Å–Ω–∏–º–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏¬ª](https://karpathy.github.io/2015/05/21/rnn-effectiveness/) –≤ –¥–æ–º–µ–Ω–µ Guess.js. –í —Ç–æ –∂–µ –≤—Ä–µ–º—è —è –Ω–∞—á–∞–ª —Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Å—Ç–æ—Ä–æ–Ω—É [—Å–≤—ë—Ä—Ç–æ—á–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π](https://ru.wikipedia.org/wiki/–°–≤—ë—Ä—Ç–æ—á–Ω–∞—è_–Ω–µ–π—Ä–æ–Ω–Ω–∞—è_—Å–µ—Ç—å) (CNN), –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è –∏ –º–µ–Ω–µ–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ, –Ω–æ —Ç–∞–∫–∂–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤. CNN –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

![MK.js —Å TensorFlow.js](./images/cover.png)

_–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ [MK.js](https://github.com/mgechev/mk.js) —Å –ø–æ–º–æ—â—å—é TensorFlow.js_

> –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–ª—è [—ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏](https://github.com/mgechev/mk-tfjs) –∏ [MK.js](https://github.com/mgechev/mk.js) –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∞ –º–æ—ë–º [GitHub-–∞–∫–∫–∞—É–Ω—Ç–µ](https://github.com/mgechev). –¢–∞–º –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö —è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª –º–æ–¥–µ–ª—å, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –Ω–∏—Ö, –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∏–∂–µ. –¢–∞–∫–∂–µ –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∂–µ—Ç–æ–≤, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —è –Ω–∞–∏–≥—Ä–∞–ª—Å—è —Å CNN, —è –≤—Å–ø–æ–º–Ω–∏–ª –æ [—Å–≤–æ—ë–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ](https://www.youtube.com/watch?v=0_yfU_iNUYo), –∫–æ—Ç–æ—Ä—ã–π —è —Å–¥–µ–ª–∞–ª –≤ –ø—Ä–æ—à–ª–æ–º –≥–æ–¥—É, –∫–æ–≥–¥–∞ –±—Ä–∞—É–∑–µ—Ä—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ API `getUserMedia`. –í —ç—Ç–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é –∫–∞–º–µ—Ä—É, —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å –≤ –Ω–µ–±–æ–ª—å—à—É—é JavaScript-–∫–æ–ø–∏—é –∏–≥—Ä—ã Mortal Kombat 3. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –∏–≥—Ä—É –Ω–∞ –º–æ—ë–º [GitHub-–∞–∫–∫–∞—É–Ω—Ç–µ](https://github.com/mgechev/mk.js). –ö–∞–∫ —á–∞—Å—Ç—å —ç—Ç–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ —è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –±–∞–∑–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–∑—ã, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—â–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∫–ª–∞—Å—Å–∞–º:

* –£–¥–∞—Ä –ø—Ä–∞–≤–æ–π –∏–ª–∏ –ª–µ–≤–æ–π —Ä—É–∫–æ–π
* –£–¥–∞—Ä –ø—Ä–∞–≤–æ–π –∏–ª–∏ –ª–µ–≤–æ–π –Ω–æ–≥–æ–π
* –ü—Ä–æ—Ö–æ–¥ –≤–ø—Ä–∞–≤–æ –∏–ª–∏ –≤–ª–µ–≤–æ
* –ü—Ä–∏—Å–µ–¥–∞–Ω–∏–µ 
* –ù–∏—á–µ–≥–æ –∏–∑ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ

–ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç–æ–π, —á—Ç–æ –µ–≥–æ –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π:

> –ê–ª–≥–æ—Ä–∏—Ç–º –¥–µ–ª–∞–µ—Ç —Å–Ω–∏–º–æ–∫ —Ñ–æ–Ω–∞ –∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å—Ü–µ–Ω–µ, –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—Ö–æ–¥–∏—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –∫–∞–¥—Ä–æ–º —Å —Ñ–æ–Ω–æ–º –∏ —Ç–µ–∫—É—â–∏–º –∫–∞–¥—Ä–æ–º —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–æ —Ç–µ–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–ª—ã–º –ø–æ —á—ë—Ä–Ω–æ–º—É —Ö–æ–ª—Å—Ç—É. –ó–∞—Ç–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã, —Å—É–º–º–∏—Ä—É—è –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–∏–∫—Å–µ–ª–µ–π. –û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Å—É–º–º–∞—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö, –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≤ –∫–∞–∫–æ–π –ø–æ–∑–µ —Å–µ–π—á–∞—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

–ù–∞ –≤–∏–¥–µ–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ —ç—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –º–æ—ë–º [GitHub-–∞–∫–∫–∞—É–Ω—Ç–µ](https://github.com/mgechev/movement.js). [–í–∏–¥–µ–æ](https://www.youtube.com/watch?v=0_yfU_iNUYo).

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ —É –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–æ–∏–º MK-–∫–ª–æ–Ω–æ–º, –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã–ª –≤—Å—ë –µ—â—ë –¥–∞–ª—ë–∫ –æ—Ç –∏–¥–µ–∞–ª–∞. –ï–º—É —Ç—Ä–µ–±–æ–≤–∞–ª—Å—è –∫–∞–¥—Ä —Å —Ñ–æ–Ω–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–∞–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ò –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∑—ã —Ä–∞–±–æ—Ç–∞–ª–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, —Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è —Ç–æ–≥–æ –∂–µ —Ü–≤–µ—Ç–∞ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã. –¢–∞–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–∑–Ω–∞—á–∞–ª–æ, —á—Ç–æ –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Å–≤–µ—â–µ–Ω–∏–∏, —Ç–µ–Ω—è—Ö –∏ —Ç. –¥. –±—É–¥—É—Ç –≤–Ω–æ—Å–∏—Ç—å –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –Ω–µ–≤–µ—Ä–Ω—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º. –ò, –Ω–∞–∫–æ–Ω–µ—Ü, –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è, –æ–Ω –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π —Å–ª–µ–¥—É—é—â–∏–π –∫–∞–¥—Ä –∫–∞–∫ –æ–¥–Ω—É –ø–æ–∑—É –∏–∑ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞.

–ò —Ç–µ–ø–µ—Ä—å, —É—á–∏—Ç—ã–≤–∞—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ API –≤–µ–±-–ø–ª–∞—Ç—Ñ–æ—Ä–º, –æ—Å–æ–±–µ–Ω–Ω–æ [WebGL](https://ru.wikipedia.org/wiki/WebGL), —è —Ä–µ—à–∏–ª –µ—â—ë —Ä–∞–∑ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É—è TensorFlow.js.

## –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ

–í —ç—Ç–æ–º –ø–æ—Å—Ç–µ —è –ø–æ–¥–µ–ª—é—Å—å —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—é –ø–æ–∑—ã, –∏—Å–ø–æ–ª—å–∑—É—è [TensorFlow.js](https://js.tensorflow.org/) –∏ [MobileNet](https://www.npmjs.com/package/@tensorflow-models/mobilenet). –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ–º:

- –°–±–æ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é [imgaug](https://github.com/aleju/imgaug)
- –ü–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è —Å MobileNet
- –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ n-–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è 
- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ TensorFlow.js —Å Node.js –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –µ—ë –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–≤ –æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π —Å LSTM

–î–ª—è —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ —è —É–ø—Ä–æ—â—É –ø—Ä–æ–±–ª–µ–º—É –¥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–∑—ã –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –∫–∞–¥—Ä–∞, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤. –ú—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–µ–º **–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—É—é –º–æ–¥–µ–ª—å –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è**, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–∞–º–µ—Ä—ã.

–ö –∫–æ–Ω—Ü—É —Å—Ç–∞—Ç—å–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è –∏–≥—Ä—ã –≤ [MK.js](https://github.com/mgechev/mk.js):

![MK.js —Å TensorFlow.js](./images/demo.gif)

**–°—Ç–∞—Ç—å—è –±—É–¥–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω–æ–π –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞–∫–æ–º—ã —Å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏ JavaScript. –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º, –Ω–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.**

## –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö

–¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å. –ù–∞–º –Ω–∞–¥–æ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –ø–æ–ª—É—á–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ. –ù–∞—à–∞ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–ø–æ—Å–æ–±–Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —É–¥–∞—Ä—ã —Ä—É–∫–∞–º–∏ –∏ –Ω–æ–≥–∞–º–∏. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞–º –Ω–∞–¥–æ —Å–æ–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ç—Ä—ë—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π:

- –£–¥–∞—Ä—ã —Ä—É–∫–∞–º–∏
- –£–¥–∞—Ä—ã –Ω–æ–≥–∞–º–∏
- –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ

–î–ª—è —ç—Ç–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ —è, —Å –ø–æ–º–æ—â—å—é –µ—â—ë –¥–≤—É—Ö –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–≤ ([lili_vs](https://twitter.com/lili_vs) –∏ [gsamokovarov](https://twitter.com/gsamokovarov)), —Å–¥–µ–ª–∞–ª –Ω–µ–º–Ω–æ–≥–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π. –ú—ã –∑–∞–ø–∏—Å–∞–ª–∏ 5 –≤–∏–¥–µ–æ –Ω–∞ QuickTime —Å –º–æ–µ–≥–æ MacBook Pro, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∞–ª–æ 2 ‚Äî 4 —É–¥–∞—Ä–∞ —Ä—É–∫–æ–π –∏ 2 ‚Äî 4 —É–¥–∞—Ä–∞ –Ω–æ–≥–æ–π. 

–¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –≤–∏–¥–µ–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `mov`, –Ω–æ –Ω—É–∂–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `ffmpeg`, —á—Ç–æ–±—ã —Ä–∞–∑–±–∏—Ç—å –≤–∏–¥–µ–æ –Ω–∞ –∫–∞–¥—Ä—ã –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –∫–∞–∫ `jpg`. 

```bash
ffmpeg -i video.mov $filename%03d.jpg
```

–ü—Ä–µ–∂–¥–µ, —á–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É, [—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ](https://www.ffmpeg.org/download.html) `ffmpeg` –Ω–∞ –≤–∞—à –∫–æ–º–ø—å—é—Ç–µ—Ä. 

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º, –Ω–æ —Å–µ–π—á–∞—Å —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –∫—É—á–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç—Ä—ë—Ö –ª—é–¥–µ–π –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ–∑–∞—Ö. –ß—Ç–æ–±—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ, –º—ã –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–¥—Ä—ã –∏–∑ –≤–∏–¥–µ–æ –Ω–∞ —Ç—Ä–∏ –ø–∞–ø–∫–∏ (–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –¥–æ —ç—Ç–æ–≥–æ): —É–¥–∞—Ä—ã —Ä—É–∫–æ–π, —É–¥–∞—Ä—ã –Ω–æ–≥–æ–π –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ —É –Ω–∞—Å –ø–æ–ª—É—á–∏—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –ø–æ 200 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ —ç—Ç–∏:

![–ü—Ä–∏–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π](./images/all.jpg)

–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤ –ø–∞–ø–∫–µ ¬´–≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ¬ª –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —á–µ–º –≤ –¥—Ä—É–≥–∏—Ö, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–¥–∞—Ä–æ–≤ –º–µ–Ω—å—à–µ, —á–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–æ—Å—Ç–æ —Å—Ç–æ—è—â–∏—Ö, —Ö–æ–¥—è—â–∏—Ö –∏–ª–∏ –≤—ã–∫–ª—é—á–∞—é—â–∏—Ö –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å—å –ª—é–¥–µ–π. –ï—Å–ª–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ —É –Ω–∞—Å –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —á–µ–º –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö, —Ç–æ –º—ã —Ä–∏—Å–∫—É–µ–º —Å–¥–µ–ª–∞—Ç—å –º–æ–¥–µ–ª—å –ø—Ä–µ–¥–≤–∑—è—Ç–æ–π –∫ —ç—Ç–æ–º—É –∫–ª–∞—Å—Å—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–∞–∂–µ –µ—Å–ª–∏ –º—ã –ø–æ–ø—ã—Ç–∞–µ–º—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑ –±—å—é—â–µ–≥–æ –Ω–æ–≥–æ–π —á–µ–ª–æ–≤–µ–∫–∞, –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –µ–≥–æ –∫–∞–∫ ¬´–≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ¬ª. –ß—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –ø—Ä–µ–¥–≤–∑—è—Ç–æ—Å—Ç—å –º–æ–¥–µ–ª–∏, –º—ã –º–æ–∂–µ–º —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –≤ ¬´–≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ¬ª –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ –±—ã–ª–æ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞, —è –ø—Ä–æ–Ω—É–º–µ—Ä—É—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ –æ—Ç `1` –¥–æ `190`, —Ç–∞–∫ —á—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥–µ—Ç `1.jpg`, –≤—Ç–æ—Ä–æ–≥–æ ‚Äî `2.jpg` –∏ —Ç. –¥.

–ï—Å–ª–∏ –º—ã –æ–±—É—á–∏–º –º–æ–¥–µ–ª—å —Ç–æ–ª—å–∫–æ –Ω–∞ 600 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö, —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –º–µ—Å—Ç–µ —Å –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –ª—é–¥—å–º–∏, —Ç–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å —ç—Ç–æ–π –º–æ–¥–µ–ª–∏ –±—É–¥–µ—Ç –Ω–µ –≤—ã—Å–æ–∫–æ–π. –ß—Ç–æ–±—ã ¬´–≤—ã–∂–∞—Ç—å¬ª –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –∏–∑ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –º—ã –∏—Ö **–¥–æ–ø–æ–ª–Ω–∏–º**.

## –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö, –ø—É—Ç–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –û–±—ã—á–Ω–æ, –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.  –ú—ã —Å–¥–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∏—Å—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ. –ù–µ —Å—Ç–æ–∏—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ —Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏: –ø—Ä–∏–º–µ–Ω—è—è –∏—Ö –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É–¥–∞—Ä–∞–º–∏, —É –Ω–∞—Å –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å—Å—è —Ç–æ–∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É–¥–∞—Ä–∞–º–∏. 

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–º–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è–º–∏ –±—É–¥—É—Ç: –≤—Ä–∞—â–µ–Ω–∏—è, –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤, —Ä–∞–∑–º—ã—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç. –¥. –í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –µ—Å—Ç—å –æ—Ç–ª–∏—á–Ω—ã–µ –æ–ø–µ–Ω—Å–æ—Ä—Å-–±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —ç—Ç–æ–≥–æ. –ù–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏—è, —è –Ω–µ –Ω–∞—à—ë–ª —Ç–∞–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ JavaScript, –ø–æ—ç—Ç–æ–º—É —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –Ω–∞–ø–∏—Å–∞–Ω–Ω—É—é –Ω–∞ Python ‚Äî [imgaug](https://github.com/aleju/imgaug). –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω—ã —Å –∫–∞–∫–æ–π-—Ç–æ –¥–æ–ª—å—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.

–≠—Ç–æ –ª–æ–≥–∏–∫–∞ –¥–ª—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—É—é —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤ –¥–∞–Ω–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ:

```python
np.random.seed(44)
ia.seed(44)

def main():
    for i in range(1, 191):
        draw_single_sequential_images(str(i), "others", "others-aug")
    for i in range(1, 191):
        draw_single_sequential_images(str(i), "hits", "hits-aug")
    for i in range(1, 191):
        draw_single_sequential_images(str(i), "kicks", "kicks-aug")

def draw_single_sequential_images(filename, path, aug_path):
    image = misc.imresize(ndimage.imread(path + "/" + filename + ".jpg"), (56, 100))
    sometimes = lambda aug: iaa.Sometimes(0.5, aug)
    seq = iaa.Sequential(
        [
            iaa.Fliplr(0.5), # –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ 50% –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
            # –æ–±—Ä–µ–∑–∞—Ç—å –æ—Ç 5% –¥–æ 10% –æ—Ç –≤—ã—Å–æ—Ç—ã/—à–∏—Ä–∏–Ω—ã –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            sometimes(iaa.CropAndPad(
                percent=(-0.05, 0.1),
                pad_mode=ia.ALL,
                pad_cval=(0, 255)
            )),
            sometimes(iaa.Affine(
                scale={"x": (0.8, 1.2), "y": (0.8, 1.2)}, # –º–∞c—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ 80-120% (–ø–æ –∫–∞–∂–¥–æ–π –æ—Å–∏ –æ—Ç–¥–µ–ª—å–Ω–æ)
                translate_percent={"x": (-0.1, 0.1), "y": (-0.1, 0.1)}, # —Å–¥–≤–∏–Ω—É—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ +/- 10% (–ø–æ –∫–∞–∂–¥–æ–π –æ—Å–∏)
                rotate=(-5, 5),
                shear=(-5, 5), # —Å–¥–≤–∏–≥ –Ω–∞ +/- 5 –≥—Ä–∞–¥—É—Å–æ–≤
                order=[0, 1], # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å–æ—Å–µ–¥–∞ –∏–ª–∏ –±–∏–ª–∏–Ω–µ–π–Ω—É—é –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—é (–±—ã—Å—Ç—Ä—É—é)
                cval=(0, 255), # –µ—Å–ª–∏ mode —ç—Ç–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º cval –º–µ–∂–¥—É 0 –∏ 255
                mode=ia.ALL # –∏–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π –∏–∑ —Ä–µ–∂–∏–º–æ–≤ –∏—Å–∫—Ä–∏–≤–ª–µ–Ω–∏—è –¥–ª—è scikit-image ( –≤—Ç–æ—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ  –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä—è–¥—É –≤ –ø—Ä–∏–º–µ—Ä–µ)
            )),
            iaa.Grayscale(alpha=(0.0, 1.0)),
            iaa.Invert(0.05, per_channel=False), # –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–≤–µ—Ç–æ–≤—ã–µ –∫–∞–Ω–∞–ª—ã
            # –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –æ—Ç 0 –¥–æ 5 —Å–ª–µ–¥—É—é—â–∏—Ö (–Ω–µ —Ç–∞–∫–∏—Ö –∑–Ω–∞—á–∏–º—ã—Ö) –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
            # –Ω–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤—Å–µ 5 –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –∑–∞ —Ä–∞–∑, —Ç–∞–∫ –∫–∞–∫ —á–∞—Å—Ç–æ –∏—Å–∫–∞–∂–µ–Ω–∏—è –±—É–¥—É—Ç —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω—ã–µ
            iaa.SomeOf((0, 5),
                [
                    iaa.OneOf([
                        iaa.GaussianBlur((0, 2.0)), # —Ä–∞–∑–º—ã—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Å–∏–≥–º–æ–π –æ—Ç 0 –¥–æ 2.0
                        iaa.AverageBlur(k=(2, 5)), # —Ä–∞–∑–º—ã—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —Å —Ä–∞–∑–º–µ—Ä–æ–º —è–¥—Ä–∞ –æ—Ç 2 –¥–æ 5
                        iaa.MedianBlur(k=(3, 5)), # —Ä–∞–∑–º—ã—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–π –º–µ–¥–∏–∞–Ω—ã —Å —Ä–∞–∑–º–µ—Ä–æ–º —è–¥—Ä–∞ –æ—Ç 3 –¥–æ 5
                    ]),
                    iaa.Sharpen(alpha=(0, 1.0), lightness=(0.75, 1.5)), # –ø–æ–≤—ã—Å–∏—Ç—å —Ä–µ–∑–∫–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    iaa.Emboss(alpha=(0, 1.0), strength=(0, 2.0)), # –ø—Ä–∏–¥–∞—Ç—å —Ä–µ–ª—å–µ—Ñ–Ω–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
                    iaa.AdditiveGaussianNoise(loc=0, scale=(0.0, 0.01*255), per_channel=0.5), # –¥–æ–±–∞–≤–∏—Ç—å –≥–∞—É—Å—Å–æ–≤—Å–∫–∏–π —à—É–º –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é
                    iaa.Add((-10, 10), per_channel=0.5), # –∏–∑–º–µ–Ω–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ( +/- 10 –æ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è)
                    iaa.AddToHueAndSaturation((-20, 20)), # –∏–∑–º–µ–Ω–∏—Ç—å –æ—Ç—Ç–µ–Ω–æ–∫ –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å
                    # –ª–∏–±–æ –∏–∑–º–µ–Ω–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å –≤—Å–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏–Ω–æ–≥–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ
                    # –∫–∞–Ω–∞–ª–∞ –æ—Ç–¥–µ–ª—å–Ω–æ) –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —è—Ä–∫–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                    iaa.OneOf([
                        iaa.Multiply((0.9, 1.1), per_channel=0.5),
                        iaa.FrequencyNoiseAlpha(
                            exponent=(-2, 0),
                            first=iaa.Multiply((0.9, 1.1), per_channel=True),
                            second=iaa.ContrastNormalization((0.9, 1.1))
                        )
                    ]),
                    iaa.ContrastNormalization((0.5, 2.0), per_channel=0.5), # —É–ª—É—á—à–∏—Ç—å –∏–ª–∏ —É—Ö—É–¥—à–∏—Ç—å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å
                ],
                random_order=True
            )
        ],
        random_order=True
    )

    im = np.zeros((16, 56, 100, 3), dtype=np.uint8)
    for c in range(0, 16):
        im[c] = image

    for im in range(len(grid)):
        misc.imsave(aug_path + "/" + filename + "_" + str(im) + ".jpg", grid[im])
```

–í —ç—Ç–æ–º –∫–æ–¥–µ –µ—Å—Ç—å `main` —Ñ—É–Ω–∫—Ü–∏—è, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π 3 —Ü–∏–∫–ª–∞ - –ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –í –∫–∞–∂–¥–æ–º —Ü–∏–∫–ª–µ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –º—ã –≤—ã–∑—ã–≤–∞–µ–º `draw_single_sequential_images` –º–µ—Ç–æ–¥ –∏ –ø–µ—Ä–µ–¥–∞–µ–º –∏–º—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–µ—Ä–≤—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, –ø—É—Ç—å –¥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - –≤—Ç–æ—Ä—ã–º, –∞ —Ç—Ä–µ—Ç—å–∏–º - –ø–∞–ø–∫—É, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. 

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å—á–∏—Ç—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –¥–∏—Å–∫–∞ –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–∏–º –Ω–∞–±–æ—Ä —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π. –Ø –æ–ø–∏—Å–∞–ª –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –≤–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –≤—ã—à–µ, –ø–æ—ç—Ç–æ–º—É –Ω–µ –±—É–¥—É –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–æ–º –∑–¥–µ—Å—å. 

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç –µ—â–µ 16 –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –≠—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –¥–æ–ø–æ–ª–Ω—è–µ–º:

![—Ç–∞–±–ª–∏—Ü–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏](./images/aug.jpg)

–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤ –∫–æ–¥–µ, –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–º –≤—ã—à–µ, –º—ã —É–º–µ–Ω—å—à–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ `100x56` –ø–∏–∫—Å–µ–ª–µ–π. –ú—ã –¥–µ–ª–∞–µ–º —ç—Ç–æ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—à–∞ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏.

## –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å!

–¢–∞–∫ –∫–∞–∫ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤—ë—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å (CNN). –≠—Ç–∞ —Å–µ—Ç–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ —Ç–µ–º, —á—Ç–æ –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –Ω–∏—Ö –∏ –∏—Ö –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ü–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è

–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–∞ VGG-16, –ø–æ–ø—É–ª—è—Ä–Ω–∞—è CNN, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. 

![vgg-16](./images/vgg-16.svg)

–°–µ—Ç—å VGG-16 –º–æ–∂–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –¥–æ 1000 –∫–ª–∞—Å—Å–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –û–Ω–∞ –∏–º–µ–µ—Ç 16 —Å–ª–æ—ë–≤ (–º—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ–º –≤—ã—Ö–æ–¥–Ω–æ–π –∏ pooling —Å–ª–æ–∏). –¢–∞–∫—É—é –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—É—é —Å–µ—Ç—å –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ–≥—Ä–æ–º–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –º–Ω–æ–≥–æ —á–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è. 

–°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏ –≤ –æ–±—É—á–µ–Ω–Ω–æ–π CNN —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞: –Ω–∞—á–∏–Ω–∞—è —Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∫—Ä–∞—ë–≤ –æ–±—ä–µ–∫—Ç–∞, –∑–∞–∫–∞–Ω—á–∏–≤–∞—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –æ–±—ä–µ–∫—Ç–∞ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º —Å–∞–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –û–±—É—á–µ–Ω–Ω–∞—è CNN, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è VGG-16, —Ä–∞—Å–ø–æ–∑–Ω–∞—é—â–∞—è –±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —É–º–µ—é—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –º–Ω–æ–≥–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–≥–æ —Å–µ—Ç–∞. –¢–∞–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±—É–¥—É—Ç –æ–±—â–∏–º–∏ –º–µ–∂–¥—É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á.

**–ü–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è** –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ –æ–±—É—á–µ–Ω–Ω—ã–µ —Å–µ—Ç–∏. –ú—ã –º–æ–∂–µ–º –±—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ª—é–±–æ–≥–æ –∏–∑ —Å–ª–æ—ë–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–µ—Ç–∏ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–æ–≤—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–æ–≤—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å –º–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –∏—Å—Ö–æ–¥–Ω–∞—è —Å–µ—Ç—å —Ä–∞–Ω–µ–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞.

![–ø–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è](./images/transfer.svg)

–î–ª—è –Ω–∞—à–∏—Ö —Ü–µ–ª–µ–π –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç **–Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å MobileNet** –∏–∑ [@tensorflow-models/mobilenet](https://www.npmjs.com/package/@tensorflow-models/mobilenet). MobileNet –Ω–∞—Å—Ç–æ–ª—å–∫–æ –∂–µ —Ö–æ—Ä–æ—à–∞ –∫–∞–∫ –∏ VGG-16, –Ω–æ –æ–Ω–∞ —Ç–∞–∫ –∂–µ –∏ –Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ, —á—Ç–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø—Ä—è–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. MobileNet –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –Ω–∞ [ILSVRC-2012-CLS](http://www.image-net.org/challenges/LSVRC/2012/) –Ω–∞–±–æ—Ä–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç MobileNet —Å–µ—Ç—å –≤ –≤–∏–¥–∂–µ—Ç–µ –Ω–∏–∂–µ (*–¥–æ—Å—Ç—É–ø–µ–Ω –≤ [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ](https://blog.mgechev.com/2018/10/20/transfer-learning-tensorflow-js-data-augmentation-mobile-net/), - –ø—Ä–∏–º. –ø–µ—Ä.*). –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ —Å–≤–æ–µ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å –∫–∞–º–µ—Ä—ã.

–ö–æ–≥–¥–∞ –º—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –Ω–∞–º –Ω–∞–¥–æ –ø—Ä–∏–Ω—è—Ç—å –≤—Å–µ–≥–æ –¥–≤–∞ —Ä–µ—à–µ–Ω–∏—è:

1. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å –∫–∞–∫–æ–≥–æ —Å–ª–æ—è –±—É–¥–µ—Ç –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏
2. –°–∫–æ–ª—å–∫–æ —Å–ª–æ—ë–≤ –≤ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –º—ã —Ö–æ—Ç–∏–º –æ–±—É—á–∞—Ç—å (–∏ —Ö–æ—Ç–∏–º –ª–∏ –º—ã –≤–æ–æ–±—â–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–∏)

–ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∞–∂–Ω–æ. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–ª–æ—è –º—ã –±—É–¥–µ–º –ø–æ–ª—É—á–∞—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ, –∫–∞–∫ –≤—ã –ø–æ–º–Ω–∏—Ç–µ, –ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞—à–µ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.

–í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º—ã –Ω–µ –±—É–¥–µ–º –æ–±—É—á–∞—Ç—å –Ω–∏ –æ–¥–∏–Ω –∏–∑ —Å–ª–æ–µ–≤ MobileNet. –ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã —Å–ª–æ—è `global_average_pooling2d_1` –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ö–∞–∫ —è –≤—ã–±—Ä–∞–ª –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç —Å–ª–æ–π? –≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–º –ø—É—Ç–µ–º. –Ø —Å–¥–µ–ª–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤, –∏ —ç—Ç–æ—Ç —Å–ª–æ–π —Ä–∞–±–æ—Ç–∞–ª –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à–æ –¥–ª—è –º–æ–∏—Ö —Ü–µ–ª–µ–π.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Å—Ç–æ—è–ª–∞ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ —Ç—Ä—ë–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: —É–¥–∞—Ä—ã —Ä—É–∫–æ–π, —É–¥–∞—Ä—ã –Ω–æ–≥–æ–π –∏ –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ. –î–∞–≤–∞–π—Ç–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–µ—à–∏–º —É–ø—Ä–æ—â—ë–Ω–Ω—É—é –∑–∞–¥–∞—á—É: –æ–ø—Ä–µ–¥–µ–ª–∏–º —Å–æ–≤–µ—Ä—à–∞–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞—Ä –≤ –∫–∞–¥—Ä–µ –∏–ª–∏ –Ω–µ—Ç. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–∞—è –∑–∞–¥–∞—á–∞ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –º–æ–¥–µ–ª—å: 

```javascript
import * as tf from '@tensorflow/tfjs';

const model = tf.sequential();
model.add(tf.layers.inputLayer({ inputShape: [1024] }));
model.add(tf.layers.dense({ units: 1024, activation: 'relu' }));
model.add(tf.layers.dense({ units: 1, activation: 'sigmoid' }));
model.compile({
  optimizer: tf.train.adam(1e-6),
  loss: tf.losses.sigmoidCrossEntropy,
  metrics: ['accuracy']
});
```

–≠—Ç–æ—Ç –∫–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å —Å–æ —Å–ª–æ–µ–º –Ω–∞ `1024` —é–Ω–∏—Ç–∞¬†–∏ `ReLU` –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π, –∏ –æ–¥–Ω–∏–º –≤—ã—Ö–æ–¥–Ω—ã–º —é–Ω–∏—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∞–∫—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `sigmoid`. –§—É–Ω–∫—Ü–∏—è `sigmoid` –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —á–∏—Å–ª–∞ –æ—Ç `0` –¥–æ `1` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä–æ—è—Ç–Ω–æ, —á—Ç–æ —á–µ–ª–æ–≤–µ–∫ –≤ –∫–∞–¥—Ä–µ –¥–µ–ª–∞–µ—Ç —É–¥–∞—Ä. –ü–æ—á–µ–º—É —è –≤—ã–±—Ä–∞–ª `1024` —é–Ω–∏—Ç–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–æ—è –∏ `1e-6` –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è? –Ø –ø—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ —É–≤–∏–¥–µ–ª, —á—Ç–æ `1024` –∏ `1e-6` –ø–æ–∫–∞–∑–∞–ª–∏ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –í–æ–∑–º–æ–∂–Ω–æ ¬´–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª –∏ —É–≤–∏–¥–µ–ª¬ª –∑–≤—É—á–∏—Ç –Ω–µ –æ—á–µ–Ω—å —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤–∞—Å, –Ω–æ –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è: –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –Ω–∞—à–∏—Ö –∑–Ω–∞–Ω–∏—è—Ö –æ –º–æ–¥–µ–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Ç—É–∏—Ü–∏—é, —á—Ç–æ–±—ã –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø–æ—Ç–æ–º –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å. 

–ú–µ—Ç–æ–¥ `compile` –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–ª–æ–∏ –º–æ–¥–µ–ª–∏ –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –æ—Ü–µ–Ω–∫–∏.¬†–í –Ω—ë–º –º—ã –æ–±–æ–∑–Ω–∞—á–∞–µ–º, —á—Ç–æ —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º `adam`. –ú—ã —Ç–∞–∫ –∂–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, —á—Ç–æ –º—ã –±—É–¥–µ–º –≤—ã—á–∏—Å–ª—è—Ç—å –ø–æ—Ç–µ—Ä–∏ —Å —Å–∏–≥–º–æ–≤–∏–¥–Ω–æ–π [–∫—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏–µ–π](https://ru.wikipedia.org/wiki/–ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–∞—è_—ç–Ω—Ç—Ä–æ–ø–∏—è) –∏ –º—ã —Ç–∞–∫ –∂–µ —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏. TensorFlow.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏:

```
–¢–æ—á–Ω–æ—Å—Ç—å = (–∏—Å—Ç–∏–Ω–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ + –∏—Å—Ç–∏–Ω–Ω–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ) / (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ + –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ)
```

–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø–µ—Ä–µ–Ω–µ—Å—ë–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ c MobileNet –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏, –º—ã —Å–ø–µ—Ä–≤–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ—ë. –¢–∞–∫ –∫–∞–∫ —ç—Ç–æ –Ω–µ–ø—Ä–∞–∫—Ç–∏—á–Ω–æ –æ–±—É—á–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å –Ω–∞ —Ç—Ä—ë—Ö —Ç—ã—Å—è—á–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Node.js –∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–µ—Ç—å –∏–∑ —Ñ–∞–π–ª–∞.

–í—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å MobileNet [–æ—Ç —Å—é–¥–∞](https://github.com/mgechev/mk-tfjs/tree/master/mobile-net). –í –ø–∞–ø–∫–µ –≤—ã –Ω–∞–π–¥—ë—Ç–µ —Ñ–∞–π–ª `model.json`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ - —Å–ª–æ–∏, –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏ —Ç. –¥. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å¬†–∏–∑ —Ñ–∞–π–ª–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

```javascript
export const loadModel = async () => {
  const mn = new mobilenet.MobileNet(1, 1);
  mn.path = `file://PATH/TO/model.json`;
  await mn.load();
  return (input): tf.Tensor1D =>
      mn.infer(input, 'global_average_pooling2d_1')
        .reshape([1024]);
};
```

–ó–∞–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤ –º–µ—Ç–æ–¥–µ `loadModel` –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –ø—Ä–∏–Ω–∏–º–∞—é—â—É—é –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é `mn.infer(input, Layer)`. `infer` - –º–µ—Ç–æ–¥ MobileNet, –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–Ω–∑–æ—Ä –∏ —Å–ª–æ–π –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü–∞—Ä–∞–º–µ—Ç—Ä `Layer` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∏–∑ –∫–∞–∫–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è –º—ã —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ï—Å–ª–∏ –≤—ã –ø–æ–∏—â–∏—Ç–µ `global_average_pooling2d_1` –≤ [`model.json`](https://github.com/mgechev/mk-tfjs/blob/master/mobile-net/model.json), —Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ, —á—Ç–æ —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏–∑ —Å–ª–æ—ë–≤. 

–¢–µ–ø–µ—Ä—å, –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å, –Ω–∞–º –Ω–∞–¥–æ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å MobileNet –º–µ—Ç–æ–¥ `infer` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –º–µ—Ç–∫—É: `1` (–µ—Å–ª–∏ –≤ –∫–∞–¥—Ä–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞—Ä–∞) –∏ `0` (–µ—Å–ª–∏ –Ω–µ—Ç).

```javascript
const punches = require('fs')
  .readdirSync(Punches)
  .filter(f => f.endsWith('.jpg'))
  .map(f => `${Punches}/${f}`);

const others = require('fs')
  .readdirSync(Others)
  .filter(f => f.endsWith('.jpg'))
  .map(f => `${Others}/${f}`);

const ys = tf.tensor1d(
  new Array(punches.length).fill(1)
    .concat(new Array(others.length).fill(0)));

const xs: tf.Tensor2D = tf.stack(
  punches
    .map((path: string) => mobileNet(readInput(path)))
    .concat(others.map((path: string) => mobileNet(readInput(path))))
) as tf.Tensor2D;
```

–í —ç—Ç–æ–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –∫–æ–¥–∞ –º—ã —Å–Ω–∞—á–∞–ª–∞ —á–∏—Ç–∞–µ–º —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —É–¥–∞—Ä–æ–≤, –∑–∞—Ç–µ–º –∏–∑ –ø–∞–ø–∫–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π —É–¥–∞—Ä–æ–≤ –Ω–µ—Ç.  –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å–æ–∑–¥–∞–µ–º –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ –º–µ—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –Ω–∞ –≤—ã—Ö–æ–¥–µ. –ï—Å–ª–∏ —É –Ω–∞—Å –±—ã–ª–æ `n` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É–¥–∞—Ä–∞–º–∏ –∏ `m` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑ —É–¥–∞—Ä–æ–≤, —Ç–æ —Ç–µ–Ω–∑–æ—Ä –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å `n` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `1` –∏ `m` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `0`. 

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è MobileNet –º–µ—Ç–æ–¥–∞ `infer` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å—Ç–µ–∫–µ `xs`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º—ã –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `readInput`. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é:

```javascript
export const readInput = img => imageToInput(readImage(img), TotalChannels);

const readImage = path => jpeg.decode(fs.readFileSync(path), true);

const imageToInput = image => {
  const values = serializeImage(image);
  return tf.tensor3d(values, [image.height, image.width, 3], 'int32');
};

const serializeImage = image => {
  const totalPixels = image.width * image.height;
  const result = new Int32Array(totalPixels * 3);
  for (let i = 0; i < totalPixels; i++) {
    result[i * 3 + 0] = image.data[i * 4 + 0];
    result[i * 3 + 1] = image.data[i * 4 + 1];
    result[i * 3 + 2] = image.data[i * 4 + 2];
  }
  return result;
};
```

`readInput` —Å–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `readImage` –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `imageToInput`. `readImage` —Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –¥–∏—Å–∫–∞ –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç –±—É—Ñ–µ—Ä –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ `jpg`, –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞–∫–µ—Ç [`jpeg-js`](https://www.npmjs.com/package/jpeg-js). –í `imageToInput` –º—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ç—Ä—ë—Ö–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä. 

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∫–æ–¥–∞, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `i` –æ—Ç `0` –¥–æ `TotalImages` –∑–Ω–∞—á–µ–Ω–∏–µ `ys[i]` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `1` (–µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ `xs[i]` —Å–æ–¥–µ—Ä–∂–∏—Ç —É–¥–∞—Ä) –∏ `0` (–µ—Å–ª–∏ –∏–Ω–∞—á–µ).

## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–∏. –î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –≤—ã–∑–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ `fit` –Ω–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ –º–æ–¥–µ–ª–∏. 

```javascript
await model.fit(xs, ys, {
  epochs: Epochs,
  batchSize: parseInt(((punches.length + others.length) * BatchSize).toFixed(0)),
  callbacks: {
    onBatchEnd: async (_, logs) => {
      console.log('Cost: %s, accuracy: %s', logs.loss.toFixed(5), logs.acc.toFixed(5));
      await tf.nextFrame();
    }
  }
});
```

–í –∫–æ–¥–µ –≤—ã—à–µ –º—ã –≤—ã–∑—ã–≤–∞–µ–º `fit` —Å —Ç—Ä–µ–º—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: `xs`, `ys` –∏ –æ–±—ä–µ–∫—Ç–æ–º —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–∫–æ–ª—å–∫–æ —ç–ø–æ—Ö –º—ã —Ö–æ—Ç–∏–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å, —Ä–∞–∑–º–µ—Ä –ø–∞—Ä—Ç–∏–∏ –∏ –∫–æ–ª–±—ç–∫, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏. 

–†–∞–∑–º–µ—Ä –ø–∞—Ä—Ç–∏–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ –∏–∑ `xs` –∏ `ys`, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –±—É–¥–µ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–π —ç–ø–æ—Ö–∏. –î–ª—è –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏ TensorFlow.js –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑ `xs` –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ `ys`, –∑–∞—Ç–µ–º –æ–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç –ø—Ä—è–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ, –ø–æ–ª—É—á–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ —Å–ª–æ—è —Å `sigmoid` –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π –∏ –∑–∞—Ç–µ–º, –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø–æ—Ç–µ—Ä—å, TensorFlow.js –≤—ã–ø–æ–ª–Ω–∏—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º `adam`.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–∞—é—â–µ–≥–æ –∫–æ–¥–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º—É –Ω–∏–∂–µ:

```bash
Cost: 0.84212, accuracy: 1.00000
eta=0.3 >---------- acc=1.00 loss=0.84 Cost: 0.79740, accuracy: 1.00000
eta=0.2 =>--------- acc=1.00 loss=0.80 Cost: 0.81533, accuracy: 1.00000
eta=0.2 ==>-------- acc=1.00 loss=0.82 Cost: 0.64303, accuracy: 0.50000
eta=0.2 ===>------- acc=0.50 loss=0.64 Cost: 0.51377, accuracy: 0.00000
eta=0.2 ====>------ acc=0.00 loss=0.51 Cost: 0.46473, accuracy: 0.50000
eta=0.1 =====>----- acc=0.50 loss=0.46 Cost: 0.50872, accuracy: 0.00000
eta=0.1 ======>---- acc=0.00 loss=0.51 Cost: 0.62556, accuracy: 1.00000
eta=0.1 =======>--- acc=1.00 loss=0.63 Cost: 0.65133, accuracy: 0.50000
eta=0.1 ========>-- acc=0.50 loss=0.65 Cost: 0.63824, accuracy: 0.50000
eta=0.0 ==========>
293ms 14675us/step - acc=0.60 loss=0.65
Epoch 3 / 50
Cost: 0.44661, accuracy: 1.00000
eta=0.3 >---------- acc=1.00 loss=0.45 Cost: 0.78060, accuracy: 1.00000
eta=0.3 =>--------- acc=1.00 loss=0.78 Cost: 0.79208, accuracy: 1.00000
eta=0.3 ==>-------- acc=1.00 loss=0.79 Cost: 0.49072, accuracy: 0.50000
eta=0.2 ===>------- acc=0.50 loss=0.49 Cost: 0.62232, accuracy: 1.00000
eta=0.2 ====>------ acc=1.00 loss=0.62 Cost: 0.82899, accuracy: 1.00000
eta=0.2 =====>----- acc=1.00 loss=0.83 Cost: 0.67629, accuracy: 0.50000
eta=0.1 ======>---- acc=0.50 loss=0.68 Cost: 0.62621, accuracy: 0.50000
eta=0.1 =======>--- acc=0.50 loss=0.63 Cost: 0.46077, accuracy: 1.00000
eta=0.1 ========>-- acc=1.00 loss=0.46 Cost: 0.62076, accuracy: 1.00000
eta=0.0 ==========>
304ms 15221us/step - acc=0.85 loss=0.63
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ —Ç–æ—á–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –∞ –ø–æ—Ç–µ—Ä–∏ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è. 

–ù–∞ –º–æ—ë–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö —è –¥–æ—Å—Ç–∏–≥ 92% —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫ –∫–æ–Ω—Ü—É –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. –ù–∏–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –≤–∏–¥–∂–µ—Ç, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–∏–≥—Ä–∞—Ç—å —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é. (*–¥–æ—Å—Ç—É–ø–µ–Ω –≤ [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ](https://blog.mgechev.com/2018/10/20/transfer-learning-tensorflow-js-data-augmentation-mobile-net/), –ø—Ä–∏–º. –ø–µ—Ä.*). –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å —Å–Ω–∏–º–æ–∫ —Å –∫–∞–º–µ—Ä—ã –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ª–∏ —Ç–∞–º —É–¥–∞—Ä.

–ò–º–µ–π—Ç–µ –≤ –≤–∏–¥—É, —á—Ç–æ —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–π –∏–∑-–∑–∞ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ —É –º–µ–Ω—è –±—ã–ª–∏.

## –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–¥–µ–ª—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –æ–±—É—á–∏–ª–∏ –º–æ–¥–µ–ª—å –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º –µ—ë –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ –ø–æ–¥–∫–ª—é—á–∏–º –∫ [MK.js](https://github.com/mgechev/mk.js)!

```javascript
const video = document.getElementById('cam');
const Layer = 'global_average_pooling2d_1';
const mobilenetInfer = m => (p): tf.Tensor<tf.Rank> => m.infer(p, Layer);
const canvas = document.getElementById('canvas');
const scale = document.getElementById('crop');

const ImageSize = {
  Width: 100,
  Height: 56
};

navigator.mediaDevices
  .getUserMedia({
    video: true,
    audio: false
  })
  .then(stream => {
    video.srcObject = stream;
  });
```

–í –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–º –≤—ã—à–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–µ –º—ã –æ–±—ä—è–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

* `video` ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ—ç–ª–µ–º–µ–Ω—Ç HTML5 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
* `Layer` ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–º—è —Å–ª–æ—è –∏–∑ MobileNet, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –±—É–¥–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—à—É –º–æ–¥–µ–ª—å
* `mobilenetInfer` ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —ç–∫–∑–µ–º–ø–ª—è—Ä MobileNet –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é; –≤–æ–∑–≤—Ä–∞—â—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Å–ª–æ—è MobileNet
* `canvas` ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç HTML5 canvas, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ
* `scale` ‚Äî —ç—Ç–æ –µ—â—ë –æ–¥–∏–Ω canvas, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–æ–≤

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–∏–¥–µ–æ —Å –∫–∞–º–µ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è –≤–∏–¥–µ–æ—ç–ª–µ–º–µ–Ω—Ç–∞. –ó–∞—Ç–µ–º –º—ã —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –æ—Ç—Ç–µ–Ω–∫–æ–≤ —Å–µ—Ä–æ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å canvas –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```javascript
const grayscale = (canvas: HTMLCanvasElement) => {
  const imageData = canvas.getContext('2d').getImageData(0, 0, canvas.width, canvas.height);
  const data = imageData.data;
  for (let i = 0; i < data.length; i += 4) {
    const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
    data[i] = avg;
    data[i + 1] = avg;
    data[i + 2] = avg;
  }
  canvas.getContext('2d').putImageData(imageData, 0, 0);
};
```

–í –∫–∞—á–µ—Å—Ç–≤–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞ —Å–æ–µ–¥–∏–Ω—è–µ–º –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–µ —Å MK.js:

```javascript
let mobilenet: (p: any) => tf.Tensor<tf.Rank>;
tf.loadModel('http://localhost:5000/model.json').then(model => {
  mobileNet
    .load()
    .then((mn: any) => mobilenet = mobilenetInfer(mn))
    .then(startInterval(mobilenet, model));
});
```

–í –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–º –∫–æ–¥–µ –º—ã —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä—É—é –º—ã –æ–±—É—á–∏–ª–∏ –≤—ã—à–µ, –∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∑–∞–≥—Ä—É–∂–∞–µ–º MobileNet. –ú—ã –ø–µ—Ä–µ–¥–∞—ë–º MobileNet –≤ –º–µ—Ç–æ–¥ `mobilenetInfer`, —á—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–µ–µ –≤—ã—á–∏—Å–ª—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è —Å–µ—Ç–∏. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `startInterval` —Å –æ–±–µ–∏–º–∏ —Å–µ—Ç—è–º–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤. 

```javascript
const startInterval = (mobilenet, model) => () => {
  setInterval(() => {
    canvas.getContext('2d').drawImage(video, 0, 0);

    grayscale(scale
      .getContext('2d')
      .drawImage(
        canvas, 0, 0, canvas.width,
        canvas.width / (ImageSize.Width / ImageSize.Height),
        0, 0, ImageSize.Width, ImageSize.Height
      ));

    const [punching] = Array.from((
      model.predict(mobilenet(tf.fromPixels(scale))) as tf.Tensor1D)
    .dataSync() as Float32Array);

    const detect = (window as any).Detect;
    if (punching >= 0.4) detect && detect.onPunch();

  }, 100);
};
```

`startInterval`¬† - –º–µ—Ç–æ–¥, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—Å—ë —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ. –°–Ω–∞—á–∞–ª–∞ –º—ã —Å–æ–∑–¥–∞—ë–º –∏–Ω—Ç–µ—Ä–≤–∞–ª, –≥–¥–µ –∫–∞–∂–¥—ã–µ `100–º—Å` –º—ã –≤—ã–∑—ã–≤–∞–µ–º –∞–Ω–æ–Ω–∏–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –í —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –º—ã —Å–Ω–∞—á–∞–ª–∞ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –≤–∏–¥–µ–æ –ø–æ–≤–µ—Ä—Ö canvas, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à —Ç–µ–∫—É—â–∏–π –∫–∞–¥—Ä. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∫–∞–¥—Ä –¥–æ `100x56` –∏ –ø—Ä–∏–º–µ–Ω—è–µ–º –∫ –Ω–µ–º—É —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –æ—Ç—Ç–µ–Ω–∫–æ–≤ —Å–µ—Ä–æ–≥–æ.

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –∫–∞–¥—Ä –≤ MobileNet, –ø–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –∂–µ–ª–∞–µ–º–æ–≥–æ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è –∏ –ø–µ—Ä–µ–¥–∞—ë–º –µ–≥–æ –Ω–∞ –≤—Ö–æ–¥ –≤ `predict` –º–µ—Ç–æ–¥ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ú–µ—Ç–æ–¥ `predict` –≤–µ—Ä–Ω—ë—Ç —Ç–µ–Ω–∑–æ—Ä —Å –æ–¥–Ω–∏–º —ç–ª–µ–º–µ–Ω—Ç–æ–º. –ò—Å–ø–æ–ª—å–∑—É—è `dataSync`, –º—ã –ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ç–µ–Ω–∑–æ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π `punching`.

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º: –µ—Å–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç —É–¥–∞—Ä –≤ –∫–∞–¥—Ä–µ –±–æ–ª—å—à–µ `0.4`, –º—ã –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ `onPunch` —É –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ `Detect`. MK.js –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å —Ç—Ä–µ–º—è –º–µ—Ç–æ–¥–∞–º–∏: `onKick`, `onPunch` –∏ `onStand`, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ª—é–±–æ–≥–æ –∏–∑ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π. 

–í–æ—Ç –∏ –≤—Å—ë! üéâ –í–æ—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!

![MK.js —Å TensorFlow.js](./images/punching.gif)

## –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —É–¥–∞—Ä–æ–≤ —Ä—É–∫–∞–º–∏ –∏ –Ω–æ–≥–∞–º–∏ —Å –ø–æ–º–æ—â—å—é n-–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Å–æ–∑–¥–∞–¥–∏–º –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å —É–¥–∞—Ä—ã —Ä—É–∫–∞–º–∏ –∏ —É–¥–∞—Ä—ã –Ω–æ–≥–∞–º–∏. –ù–∞—á–Ω—ë–º —Å –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:

```javascript
const punches = require('fs')
  .readdirSync(Punches)
  .filter(f => f.endsWith('.jpg'))
  .map(f => `${Punches}/${f}`);

const kicks = require('fs')
  .readdirSync(Kicks)
  .filter(f => f.endsWith('.jpg'))
  .map(f => `${Kicks}/${f}`);

const others = require('fs')
  .readdirSync(Others)
  .filter(f => f.endsWith('.jpg'))
  .map(f => `${Others}/${f}`);

const ys = tf.tensor2d(
  new Array(punches.length)
    .fill([1, 0, 0])
    .concat(new Array(kicks.length).fill([0, 1, 0]))
    .concat(new Array(others.length).fill([0, 0, 1])),
  [punches.length + kicks.length + others.length, 3]
);

const xs: tf.Tensor2D = tf.stack(
  punches
    .map((path: string) => mobileNet(readInput(path)))
    .concat(kicks.map((path: string) => mobileNet(readInput(path))))
    .concat(others.map((path: string) => mobileNet(readInput(path))))
) as tf.Tensor2D;
```
 
–ö–∞–∫ –∏ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –º–æ–¥–µ–ª–∏, –º—ã –Ω–∞—á–Ω—ë–º —Å —Ç–æ–≥–æ, —á—Ç–æ –∑–∞–≥—Ä—É–∑–∏–º –ø–∞–ø–∫–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —É–¥–∞—Ä–æ–≤ –Ω–æ–≥–æ–π, —É–¥–∞—Ä–æ–≤ —Ä—É–∫–æ–π –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –¥–≤—É—Ö–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä, –∞ –Ω–µ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ä–∞–∑–¥–µ–ª–µ. –ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å `n` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É–¥–∞—Ä–∞–º–∏ —Ä—É–∫–æ–π, `m` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —É–¥–∞—Ä–∞–º–∏ –Ω–æ–≥–æ–π –∏ `k` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å–æ –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º, —Ç–æ —Ç–µ–Ω–∑–æ—Ä `ys` –±—É–¥–µ—Ç –∏–º–µ—Ç—å `n` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ `[1,0,0]`, `m` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ `[0,1,0]` –∏ `k` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ `[0,0,1]`. –í–µ–∫—Ç–æ—Ä `[1,0,0]` –∞—Å—Å–æ—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —É–¥–∞—Ä —Ä—É–∫–æ–π, –≤–µ–∫—Ç–æ—Ä `[0,1,0]` - —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —É–¥–∞—Ä –Ω–æ–≥–æ–π, –≤–µ–∫—Ç–æ—Ä `[0,0,1]` - —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏. 

–í–µ–∫—Ç–æ—Ä —Å `n` —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º `n - 1` —ç–ª–µ–º–µ–Ω—Ç - —ç—Ç–æ –Ω—É–ª–∏, –∞ `1` —ç–ª–µ–º–µ–Ω—Ç - —ç—Ç–æ –µ–¥–∏–Ω–∏—Ü–∞, –±—É–¥–µ–º –Ω–∞–∑—ã–≤–∞—Ç—å —É–Ω–∏—Ç–∞—Ä–Ω—ã–º –∫–æ–¥–æ–º.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —Ñ–æ—Ä–º–∏—Ä—É–µ–º –≤—Ö–æ–¥–Ω–æ–π —Ç–µ–Ω–∑–æ—Ä `xs`, —Å–æ—Ö—Ä–∞–Ω—è—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ MobileNet –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. 

–î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏, –Ω–∞–º –Ω–∞–¥–æ –æ–±–Ω–æ–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:

```javascript
const model = tf.sequential();
model.add(tf.layers.inputLayer({ inputShape: [1024] }));
model.add(tf.layers.dense({ units: 1024, activation: 'relu' }));
model.add(tf.layers.dense({ units: 3, activation: 'softmax' }));
await model.compile({
  optimizer: tf.train.adam(1e-6),
  loss: tf.losses.sigmoidCrossEntropy,
  metrics: ['accuracy']
});
```

–ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–≤–∞ –æ—Ç–ª–∏—á–∏—è –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –º–æ–¥–µ–ª–∏:

* –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —é–Ω–∏—Ç–æ–≤ –≤ –≤—ã—Ö–æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏
* –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ

–ü—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ 3 —é–Ω–∏—Ç–∞ –≤ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ, —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ —Ä–∞–∑–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

* –£–¥–∞—Ä—ã —Ä—É–∫–æ–π
* –£–¥–∞—Ä—ã –Ω–æ–≥–æ–π
* –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ

–ê–∫—Ç–∏–≤–∞—Ü–∏—è Softmax –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–≤–µ—Ä—Ö —ç—Ç–∏—Ö —Ç—Ä—ë—Ö —é–Ω–∏—Ç–æ–≤ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ç–µ–Ω–∑–æ—Ä —Å —Ç—Ä–µ–º—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –ü–æ—á–µ–º—É —É –Ω–∞—Å 3 —é–Ω–∏—Ç–∞ –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–º —Å–ª–æ–µ? –ú—ã –∑–Ω–∞–µ–º, —á—Ç–æ –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å `3` –∑–Ω–∞—á–µ–Ω–∏—è (–ø–æ –æ–¥–Ω–æ–º—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞) —Å `2` –±–∏—Ç–∞–º–∏: `00`, `01`, `10`. –°—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Ç–µ–Ω–∑–æ—Ä–∞, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö `softmax`, —Ä–∞–≤–Ω–∞ `1`, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–ª—É—á–∏–º `00`, –ø–æ—ç—Ç–æ–º—É –º—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–º–æ–∂–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–∑ –∫–ª–∞—Å—Å–æ–≤.

–ü–æ—Å–ª–µ 500 —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, —è –¥–æ–±–∏–ª—Å—è –æ–∫–æ–ª–æ 92% —Ç–æ—á–Ω–æ—Å—Ç–∏! –≠—Ç–æ –Ω–µ–ø–ª–æ—Ö–æ, –∏ –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ, —á—Ç–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. 

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ! –ü–æ—Å–∫–æ–ª—å–∫—É –ª–æ–≥–∏–∫–∞ –¥–ª—è —ç—Ç–æ–≥–æ –¥–æ–≤–æ–ª—å–Ω–æ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã –¥–µ–ª–∞–ª–∏ –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏, –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º—ã –≤—ã–±–∏—Ä–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏:

```javascript
const [punch, kick, nothing] = Array.from((model.predict(
  mobilenet(tf.fromPixels(scaled))
) as tf.Tensor1D).dataSync() as Float32Array);

const detect = (window as any).Detect;
if (nothing >= 0.4) return;

if (kick > punch && kick >= 0.35) {
  detect.onKick();
  return;
}
if (punch > kick && punch >= 0.35) detect.onPunch();
```

–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ, –º—ã –≤—ã–∑—ã–≤–∞–µ–º MobileNet –º–æ–¥–µ–ª—å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä –æ—Ç—Ç–µ–Ω–∫–æ–≤ —Å–µ—Ä–æ–≥–æ –∏ –±—ã–ª–∏ —É–º–µ–Ω—å—à–µ–Ω—ã, –ø–æ—Å–ª–µ —á–µ–≥–æ –º—ã –ø–µ—Ä–µ–¥–∞–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –Ω–∞—à—É –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å. –ú–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π —Ç–µ–Ω–∑–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø—Ä–∏–≤–æ–¥–∏–º –∫ `Float32Array` —Å –ø–æ–º–æ—â—å—é `dataSync`. –ó–∞—Ç–µ–º, –∏—Å–ø–æ–ª—å–∑—É—è `Array.from`, –º—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ –∫ JavaScript-–º–∞—Å—Å–∏–≤—É –∏ –ø–æ–ª—É—á–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —É–¥–∞—Ä —Ä—É–∫–æ–π, —É–¥–∞—Ä –Ω–æ–≥–æ–π –∏–ª–∏ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ. 

–ï—Å–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–µ —É–¥–∞—Ä —Ä—É–∫–æ–π –∏ –Ω–µ —É–¥–∞—Ä –Ω–æ–≥–æ–π –≤—ã—à–µ `0.4`, –º—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —É –Ω–∞—Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —É–¥–∞—Ä –Ω–æ–≥–æ–π –∏ —ç—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã—à–µ `0.32` –º—ã –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—É `kick` –∏–∑ MK.js. –ï—Å–ª–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–¥–∞—Ä–∞ —Ä—É–∫–æ–π –≤—ã—à–µ `0.36` –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É–¥–∞—Ä–∞ —Ä—É–∫–æ–π –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —É–¥–∞—Ä–∞ –Ω–æ–≥–æ–π - –º—ã –≤—ã–∑—ã–≤–∞–µ–º `punch` –¥–µ–π—Å—Ç–≤–∏–µ. 

–ò —ç—Ç–æ –≤—Å–µ! –í—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∏–∂–µ:

![MK.js —Å TensorFlow.js](./images/demo.gif)

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–∏–≥—Ä–∞—Ç—å —Å–æ —Å–ª–µ–¥—É—é—â–∏–º –≤–∏–¥–∂–µ—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—É—é –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å, –≤—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–ª–∏ —Å –≤–∞—à–µ–π –∫–∞–º–µ—Ä—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–æ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º, –≥–¥–µ –≤—ã –±—å—ë—Ç–µ —Ä—É–∫–æ–π –∏–ª–∏ –Ω–æ–≥–æ–π! (*–¥–æ—Å—Ç—É–ø–µ–Ω –≤ [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ](https://blog.mgechev.com/2018/10/20/transfer-learning-tensorflow-js-data-augmentation-mobile-net/), - –ø—Ä–∏–º. –ø–µ—Ä.*)

## –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

–ï—Å–ª–∏ –º—ã —Å–æ–±–µ—Ä—ë–º –±–æ–ª—å—à–æ–π –∏ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ª—é–¥—å–º–∏, –±—å—é—â–∏–º–∏ —Ä—É–∫–æ–π –∏–ª–∏ –Ω–æ–≥–æ–π, –º—ã —Å–º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞–¥—Ä–∞—Ö. –û–¥–Ω–∞–∫–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —ç—Ç–æ–≥–æ? –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Å–¥–µ–ª–∞—Ç—å –µ—â—ë –æ–¥–∏–Ω —à–∞–≥ –∏ –≤—ã–¥–µ–ª–∏—Ç—å –¥–≤–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞ —É–¥–∞—Ä–æ–≤ –Ω–æ–≥–æ–π: –ø—Ä—è–º–æ–π —É–¥–∞—Ä –∏ —É–¥–∞—Ä —Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–º. 

–ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω—ã—Ö –Ω–∏–∂–µ —Å–Ω–∏–º–∫–æ–≤, –æ–±–∞ —É–¥–∞—Ä–∞ –±—É–¥—É—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —É–≥–ª–∞:

![–ø—Ä—è–º–æ–π —É–¥–∞—Ä](./images/roundhouse.png)
![—É–¥–∞—Ä —Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–º](./images/back.png)

–ù–æ –µ—Å–ª–∏ –º—ã –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –¥–≤–∏–∂–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ–≤—Å–µ–º –¥—Ä—É–≥–∏–º–∏:

![–ø—Ä—è–º–æ–π —É–¥–∞—Ä –∏ —É–¥–∞—Ä —Å —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–º](./images/back-kick.gif)

–ò—Ç–∞–∫, –∫–∞–∫ –∂–µ –º—ã –Ω–∞—É—á–∏–º –Ω–∞—à—É –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å –∏–∑—É—á–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–¥—Ä–æ–≤, –∞ –Ω–µ –æ–¥–∏–Ω?

–î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –º—ã –º–æ–∂–µ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –∫–ª–∞—Å—Å –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–º–∏ –Ω–µ–π—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏ (RNN). RNN –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ä—è–¥–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

* [–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞](https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D0%B5%D1%81%D1%82%D0%B5%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B0) (NLP), –≥–¥–µ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –¥–æ –∏ –ø–æ—Å–ª–µ
* –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–µ—Ç–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
* –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–¥—Ä–æ–≤

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–∫–æ–π –º–æ–¥–µ–ª–∏ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏, –Ω–æ –¥–∞–≤–∞–π—Ç–µ –≤–∑–≥–ª—è–Ω–µ–º –Ω–∞ —Ç–∏–ø–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ!

### –°–∏–ª–∞ RNN

–ù–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –Ω–∏–∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∞ –º–æ–¥–µ–ª—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π:

![RNN –∏ CNN](./images/cnn-rnn.svg)

–ú—ã –±–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ `n` –∫–∞–¥—Ä–æ–≤ –∏–∑ –≤–∏–¥–µ–æ –∏ –ø–µ—Ä–µ–¥–∞—ë–º –∏—Ö –≤ CNN. –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã CNN –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–¥—Ä–∞, –º—ã –ø–µ—Ä–µ–¥–∞—ë–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–∞ –≤ RNN. –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–∞–¥—Ä–∞–º–∏ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç, –∫–∞–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –æ–Ω–∏ –∫–æ–¥–∏—Ä—É—é—Ç.

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏ –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –º—ã —Å–æ–±—Ä–∞–ª–∏ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —Ä–∞–∑–±–∏–ª–∏ –≤–∏–¥–µ–æ –Ω–∞ –∫–∞–¥—Ä—ã –∏ –≤—Ä—É—á–Ω—É—é —Ä–∞–∑–¥–µ–ª–∏–ª–∏ –∏—Ö –Ω–∞ —Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ó–∞—Ç–µ–º –º—ã –¥–æ–ø–æ–ª–Ω–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é [imgaug](https://github.com/aleju/imgaug).

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º—ã —É–∑–Ω–∞–ª–∏ —á—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ–Ω–æ—Å –æ–±—É—á–µ–Ω–∏—è –∏ –∫–∞–∫ –º—ã —Å–º–æ–∂–µ–º —Å –µ–≥–æ –ø–æ–º–æ—â—å—é –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å MobileNet –∏–∑ [`@tensorflow-models/mobilenet`](https://www.npmjs.com/package/@tensorflow-models/mobilenet). –ú—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ MobileNet –∏–∑ —Ñ–∞–π–ª–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å Node.js  –∏ –æ–±—É—á–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π, –≤ –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä—ã—Ç–æ–≥–æ —Å–ª–æ—è MobileNet. –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º—ã –¥–æ–±–∏–ª–∏—Å—å –±–æ–ª–µ–µ —á–µ–º 90-–ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏!

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏, –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –º—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ –µ—ë –∏–∑ —Ñ–∞–π–ª–∞ –≤–º–µ—Å—Ç–µ —Å MobileNet –∏ –∑–∞—Ç–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∏ –∫–∞–¥—Ä—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–∞–º–µ—Ä—ã –∫–∞–∂–¥—ã–µ `100–º—Å`. –ú—ã –ø–æ–¥–∫–ª—é—á–∏–ª–∏ –º–æ–¥–µ–ª—å –∫ –∏–≥—Ä–µ [MK.js](https://github.com/mgechev/mk.js) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–∏–º –∏–∑ –≥–µ—Ä–æ–µ–≤.

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏, –∫–∞–∫ –º—ã –º–æ–∂–µ–º —É–ª—É—á—à–∏—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –µ—ë —Å —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç—å—é –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π.

–ù–∞–¥–µ—é—Å—å, –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è —ç—Ç–æ—Ç –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–æ–µ–∫—Ç —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∏ –º–Ω–µ! üôá

- - - -

*–°–ª—É—à–∞–π—Ç–µ –Ω–∞—à –ø–æ–¥–∫–∞—Å—Ç –≤ [iTunes](https://itunes.apple.com/ru/podcast/–¥–µ–≤—à–∞—Ö—Ç–∞/id1226773343) –∏ [SoundCloud](https://soundcloud.com/devschacht), —á–∏—Ç–∞–π—Ç–µ –Ω–∞—Å –Ω–∞ [Medium](https://medium.com/devschacht), –∫–æ–Ω—Ç—Ä–∏–±—å—é—Ç—å—Ç–µ –Ω–∞ [GitHub](https://github.com/devSchacht), –æ–±—â–∞–π—Ç–µ—Å—å –≤ [–≥—Ä—É–ø–ø–µ Telegram](https://t.me/devSchacht), —Å–ª–µ–¥–∏—Ç–µ –≤ [Twitter](https://twitter.com/DevSchacht) –∏ [–∫–∞–Ω–∞–ª–µ Telegram](https://t.me/devSchachtChannel), —Ä–µ–∫–æ–º–µ–Ω–¥—É–π—Ç–µ –≤ [VK](https://vk.com/devschacht) –∏ [Facebook](https://www.facebook.com/devSchacht).*